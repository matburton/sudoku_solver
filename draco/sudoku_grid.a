
        xdef    getSquarePointer
        xdef    cloneIntoGrid
        xdef    getPossibilityCount
        xdef    getSquareValue
        xdef    isPossible
        xdef    isComplete

getSquareOffset macro
        moveq   #0,d0
        move.l  (sp)+,a0
        movem.w (sp)+,d0/d1
        move.l  (sp)+,a1
        mulu.w  2(a1),d0
        add.w   d1,d0
        mulu.w  14(a1),d0
        add.w   #20,d0
        endm

getSquarePointer      
        getSquareOffset
        add.l   a1,d0
        jmp     (a0)
        
cloneIntoGrid
        movem.l (sp)+,d0/a0/a1
        move.w  12(a1),d1
        lsr.w   #1,d1
        dbt     d1,cigexit
cigloop move.w  (a1)+,(a0)+
        dbf     d1,cigloop
cigexit move.l  d0,a0
        jmp     (a0)

getSquareCachedValue macro
        getSquareOffset
        add.l   d0,a1
        moveq   #0,d0
        move.b  \1(a1),d0
        jmp     (a0)
        endm

getPossibilityCount
        getSquareCachedValue 0

getSquareValue
        getSquareCachedValue 1

isGridCachedValueZero macro
        movem.l (sp)+,a0/a1
        tst.w   \1+12(a1)
        bne     nz\@
        moveq   #1,d0
        jmp     (a0)
nz\@    moveq   #0,d0
        jmp     (a0)
        endm

isPossible
        isGridCachedValueZero 4
        
isComplete
        isGridCachedValueZero 6

end